(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{6978:function(e,t,r){Promise.resolve().then(r.bind(r,92918))},91933:function(e,t,r){"use strict";var n=r(9268),a=r(35846),s=r.n(a),o=r(86006);let i={regular:"max-w-xs text-white bg-primary hover:opacity-2 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded text-sm px-5 py-2.5 text-center hover:bg-secondary text-[13px] md:text-sm lg:text-15px leading-4 h-11 md:h-[50px] px-5 lg:px-6 py-4 md:py-3.5 lg:py-4"};t.Z=o.memo(function(e){let{label:t,nameIcon:r,type:a="button",location:o="",design:l="regular",width:c="120px",handleClick:u=()=>{}}=e,d="".concat(i[l]," w-[").concat(c,"]");return o?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(s(),{className:"".concat(d),href:o,children:[(0,n.jsx)("i",{className:"fas ".concat(r)})," ",t]})}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("button",{className:"".concat(d),type:a,onClick:u,children:[(0,n.jsx)("i",{className:"fas ".concat(r)})," ",t]})})})},92918:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(9268),a=r(19700),s=r(92664),o=r(91933),i=r(28605),l=r(69799),c=r(36596);function u(e){let{action:t="a",id:r=""}=e,{register:u,handleSubmit:d,formState:{errors:m}}=(0,a.cI)({mode:"onChange"}),{changePassword:p}=(0,i.U)(),{idUser:f}=(0,c.a)(),x=async e=>{let{password:t="password",confirmPassword:r="confirmPassword",passwordBefore:n}=e;if(t!==r){(0,l.G)({message:"Las contrase\xf1as no son iguales"});return}await p({id:f,body:{password:t,passwordBefore:n}})};return(0,n.jsxs)("form",{className:"space-y-6",onSubmit:d(x),children:[(0,n.jsx)("h2",{className:"text-brand-dark text-base lg:text-lg xl:text-[20px] font-semibold xl:leading-8 mb-5 md:mb-6 lg:mb-7 lg:-mt-1",children:"Reestablecer contrase\xf1a"}),(0,n.jsx)("div",{className:"grid lg:grid-cols-2 gap-5",children:(0,n.jsx)(s.Z,{name:"passwordBefore",label:"Contrase\xf1a Anterior",type:"password",errors:m,validations:{...u("passwordBefore",{required:!0,minLength:5})}})}),(0,n.jsxs)("div",{className:"grid lg:grid-cols-2 gap-5",children:[(0,n.jsx)(s.Z,{name:"password",label:"Nueva contrase\xf1a",type:"password",errors:m,validations:{...u("password",{required:!0,minLength:5})}}),(0,n.jsx)(s.Z,{name:"confirmPassword",label:"Confirmar contrase\xf1a",type:"password",errors:m,validations:{...u("confirmPassword",{required:!0,minLength:5})}})]}),(0,n.jsx)("hr",{className:"mt-6 border-b-1 border-blueGray-300"}),(0,n.jsx)(o.Z,{label:"Reestablecer",type:"submit",width:""})]})}},92664:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(9268),a=r(86006);function s(e){var t;let{label:r="Not label",name:s,type:o="text",errors:i,validations:l,amountMinLength:c=5}=e,u=(0,a.useId)(1,"login-email-"),d=null===(t=i[s])||void 0===t?void 0:t.type,m="required"===d,p="pattern"===d,f="minLength"===d,x=m||p||f?"red":"gray";return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("label",{htmlFor:u,className:"block font-normal text-sm leading-none mb-3 cursor-pointer text-".concat(x,"-500"),children:r}),(0,n.jsx)("input",{type:o,step:"any",id:u,className:"px-5 text-heading outline-none w-full h-[52px] ltr:pl-5 rtl:pr-5 md:ltr:pl-6 md:rtl:pr-6 ltr:pr-14 rtl:pl-14 md:ltr:pr-16 md:rtl:pl-16 bg-brand-light text-sm lg:text-15px rounded-md transition-all duration-200 border border-".concat(d?x+"-500":"gray-200"),...l}),m&&(0,n.jsxs)("p",{className:"mt-2 text-xs text-red-500",children:[(0,n.jsx)("span",{className:"font-medium",children:"Oops!"})," Este campo es requerido"]}),p&&(0,n.jsxs)("p",{className:"mt-2 text-xs text-red-500",children:[(0,n.jsx)("span",{className:"font-medium",children:"Oops!"})," Ingresa un correo v\xe1lido"]}),f&&(0,n.jsxs)("p",{className:"mt-2 text-xs text-red-500",children:[(0,n.jsx)("span",{className:"font-medium",children:"Oops!"})," Caract\xe9res m\xednimos es"," ",c]})]})})}},27762:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthContext:function(){return o},default:function(){return i}});var n=r(9268),a=r(86006);function s(e,t){let[r,n]=(0,a.useState)(t);return(0,a.useDebugValue)(r),(0,a.useEffect)(()=>{let t=localStorage.getItem(e);t&&n(function(e){try{return JSON.parse(e)}catch(t){return e}}(t))},[]),(0,a.useEffect)(()=>{r&&localStorage.setItem(e,JSON.stringify(r))},[r]),[r,n]}let o=a.createContext({});function i(e){let{children:t}=e,[r,a]=s("jwt",""),[i,l]=s("user",{});return(0,n.jsx)(o.Provider,{value:{jwt:r,setJwt:a,user:i,setUser:l},children:t})}},84894:function(e,t,r){"use strict";r.r(t),r.d(t,{LoadingContext:function(){return s},default:function(){return o}});var n=r(9268),a=r(86006);let s=a.createContext({});function o(e){let{children:t}=e,[r,o]=(0,a.useState)(!1);return(0,n.jsx)(s.Provider,{value:{loading:r,setLoading:o},children:t})}},36596:function(e,t,r){"use strict";r.d(t,{a:function(){return l}});var n=r(86006),a=r(56008),s=r(27762),o=r(19124);let i={"Content-Type":"application/json"},l=()=>{let{tryCatch:e}=(0,o.V)(),{jwt:t,setJwt:r,user:l,setUser:c}=(0,n.useContext)(s.AuthContext),u=(0,a.useRouter)(),d=async t=>{let{email:n,password:a}=t;e(async()=>{let e=await fetch("/api/auth/login",{method:"POST",headers:i,body:JSON.stringify({email:n,password:a})}),t=await e.json();return t},e=>{let{token:t="",user:n={}}=e;r(t),c(n),u.push("/account")})},m=async()=>{e(async()=>{let e=await fetch("/api/auth/logout"),t=await e.json();return t},()=>{window.localStorage.clear(),r(""),u.push("/login")})};return{isLogged:!!t,jwt:t,setJwt:r,idUser:null==l?void 0:l.id,login:d,logout:m,HEADERS:{...i,Authorization:"Bearer ".concat(t)}}}},19124:function(e,t,r){"use strict";r.d(t,{V:function(){return i}});var n=r(69799);let a=e=>{let{message:t="Error de conexion no mapeado",isError:r}=e;return r&&(0,n.G)({message:t}),{isError:r}};var s=r(16554),o=r(56008);let i=()=>{let{showLoading:e,hideLoading:t}=(0,s.r)(),r=(0,o.useRouter)(),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"TokenExpiredError"===e||"JsonWebTokenError"===e||"NotBeforeError"===e},i=async function(s){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e();try{let e=await s(),{name:i}=e;t(),n(i)&&r.push("/logout");let{isError:l}=a(e);return l||(e=await o(e)),e}catch(e){t(),a({isError:!0})}},l=async r=>{e();try{let e=await r();return a(e),t(),e}catch(e){t(),a({isError:!0})}},c=async(r,n)=>{e();try{let e=await r();t();let{isError:s}=a(e);s||n(e)}catch(e){t(),a({isError:!0})}};return{tryCatchReturnResponse:l,tryCatchOnlyActions:c,tryCatch:i}}},16554:function(e,t,r){"use strict";r.d(t,{r:function(){return s}});var n=r(86006),a=r(84894);let s=()=>{let{loading:e,setLoading:t}=(0,n.useContext)(a.LoadingContext);return{isLoading:!!e,showLoading:()=>t(!0),hideLoading:()=>t(!1)}}},28605:function(e,t,r){"use strict";r.d(t,{U:function(){return o}});var n=r(19124),a=r(69799),s=r(56008);let o=()=>{let{tryCatch:e}=(0,n.V)(),t=(0,s.useRouter)(),r=async()=>e(async()=>{let e=await fetch("/api/users/getAll"),t=await e.json();return t},e=>{let t=e.map(e=>{var t;return{...e,rolename:null==e?void 0:null===(t=e.role)||void 0===t?void 0:t.name}});return t}),o=async()=>e(async()=>{let e=await fetch("/api/users/getAll?state=1"),t=await e.json();return t},e=>{let t=e.map(e=>{var t;return{...e,rolename:null==e?void 0:null===(t=e.role)||void 0===t?void 0:t.name}});return t}),i=async t=>{let{id:r}=t;return e(async()=>{let e=await fetch("/api/users/getOne?id=".concat(r)),t=await e.json();return t},e=>{let{role:t={}}=e,r={...e,idRole:t};return r})},l=async r=>e(async()=>{let e=await fetch("/api/users/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),t=await e.json();return t},()=>{(0,a.w)({message:"\xa1Usuario agregado!"}),t.push("/account/users")}),c=async(r,n)=>e(async()=>{let e=await fetch("/api/users/edit?id=".concat(r),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),t=await e.json();return t},()=>{(0,a.w)({message:"\xa1Usuario editado!"}),t.push("/account/users")}),u=async r=>{let{id:n,body:s}=r;return e(async()=>{let e=await fetch("/api/users/changePassword?id=".concat(n),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json();return t},()=>{(0,a.w)({message:"\xa1Contrase\xf1a reestablecida!"}),t.push("/account/users")})};return{getAllUsers:r,getActivedUsers:o,getOneUser:i,addNewUser:l,editUser:c,changePassword:u}}},69799:function(e,t,r){"use strict";r.d(t,{G:function(){return s},w:function(){return o}});var n=r(40856),a=r.n(n);let s=e=>{let{message:t}=e;a().fire({icon:"error",html:"<h4>".concat(t,"</h4>"),timer:3e3,showConfirmButton:!1,width:400,padding:"2em 3em",background:"#fff url(/images/trees.png)",backdrop:"\n    rgba(123, 0, 0, 0.4)\n    left top\n    no-repeat\n  "})},o=e=>{let{message:t}=e;a().fire({icon:"success",html:"<h4>".concat(t,"</h4>"),timer:3e3,showConfirmButton:!1,width:400,padding:"2em 3em",backdrop:"\n    rgba(129, 233, 121, 0.4)\n    left top\n    no-repeat\n  "})}}},function(e){e.O(0,[377,846,700,667,488,744],function(){return e(e.s=6978)}),_N_E=e.O()}]);